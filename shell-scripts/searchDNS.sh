#!/bin/bash

#################################################################
#   Repositorio:    Pentest Scripts                              #
#   Nome:           Search DNS                                  #
#   Descrição:      Consulta Registros DNS                      #
#   Autor:          Carine Constantino                          #
#   Versão:         1.0                                         #
#   Data:           27/01/2020                                  #                                      
#   Função:         Script para consultar os registros DNS de   #  
#                   um domínio e testar a transferência de zona.#
#                                                               #
#################################################################

if [ "$1" == "" ]
then		

		echo "Search DNS"
	        echo "Informe um domínio para consulta"
		echo "$0 exemplo.com.br"

	else


		echo "Escolha o Registro DNS: "
		echo " "
		echo "0 - Name Server - NS"
		echo "1 - IPv4 - A"
		echo "2 - IPv6 - AAAA"
		echo "3 - CNAME"
		echo "4 - Mail Server - MX"
		echo "5 - Reverse DNS - PTR"
		echo "6 - TXT"
		echo "7 - SOA"
		echo "8 - Transferência de Zona"
		echo " "


		read resposta 

		case $resposta in "0")

			echo "Registro DNS Name Server - NS"
			echo "$(host -t ns $1)" ;;

		"1")


			echo "Registro DNS A - IPv4"
			echo "$(host -t a $1)" ;;

		"2")

			echo "Registro DNS AAAA - IPv6"
			echo "$(host -t aaaa $1)" ;;

		"3")

			echo "Registro DNS CNAME"
			echo "$(host -t cname $1)" ;;

		"4")

			echo "Registro DNS Mail Server - MX"
			echo "$(host -t mx  $1)" ;;

		"5")

			echo "Registro DNS Reverso - PTR"
			echo "$(host -t ptr $1)" ;;

		"6")

			echo "Registro DNS TXT"
			echo "$(host -t TXT $1)" ;;

		"7")

			echo "Registro DNS SOA"
			echo "$(host -t SOA $1)" ;;
			

		"8")

			echo "Transferência de Zona"
			host -t ns $1 | cut -d " " -f 4 > nameserver.log
			echo "$(for ns in $(cat nameserver.log);do host -l -a $ns; done)" ;;
                       

	esac

fi
