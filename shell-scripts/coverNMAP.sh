#!/bin/bash

#################################################################
#   Repositorio:    Pentest Scrpts                              #
#   Nome:           Cover do NMAP                               #
#   Descrição:      Realiza scan na rede em portas específicas  #
#   Autor:          Carine Constantino                          #
#   Versão:         1.0                                         #
#   Data:           07/01/2020                                  #                                      
#   Função:         Utiliza o HPING3 para executar scan na      #  
#                   rede em portas específicas.                 #
#                                                               #
#################################################################

if [ "$1" == "" ]
then
	echo "Cover do NMAP"
	echo "Informe a rede e a(as) porta(s) para executar o scan"
	echo "Exemplo: $0 172.16.1 80"

else
	echo "Dados - HOST $1 - PORTS $2" |& tee audit.$(date +%Y-%m-%d_%H:%M).log
	echo "--------------------------"
	for ip in {1..254};
	do 
		hping3 -S -p $2 -c 1 $1.$ip 2> /dev/null | grep "flags=SA" | cut -d " " -f 2 | cut -d "=" -f 2; > log.txt


	done
fi


