#!/usr/bin/bash

#################################################################
#   Repositorio:    Pentest Scripts                             #
#   Nome:           REverse DNS                                 #
#   Descrição:      Consulta Registros PTR                      #
#   Autor:          Carine Constantino                          #
#   Versão:         1.0                                         #
#   Data:           13/02/2020                                  #                                      
#   Função:         Script para consultar os registros PTR e    #
#		    identificar domínios a partir de um bloco   #
#		    de endereços IP's.                          #
#                                                               #
#################################################################

if [ -z "$1" ] || [ -z "$2" ]
then

	echo "reverseDNS"
	echo "Informe uma sequência e uma rede"
	echo "Exemplo: $0 "1 254" 192.168.1"

else
	echo "ReverseDNS"
	echo "Report - Date: $(date)"
	echo "---------------------------"

	for ip in $(seq $1);

	do 
		host -t ptr $2.$ip >> log.txt
		awk '/\com/{print $5}' log.txt 2> /dev/null
		cat log.txt | cut -d " " -f 5 -s | grep -v "NXDOMAIN"
		rm log.txt
				

	done

fi
