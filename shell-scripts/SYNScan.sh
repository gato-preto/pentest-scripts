#!/bin/bash

#################################################################
#   Repositorio:    Pentest Scrpts                              #
#   Nome:           Syn Scan                                    #
#   Descrição:      Send SYN Packet                             #
#   Autor:          Carine Constantino                          #
#   Versão:         1.0                                         #
#   Data:           07/01/2020                                  #                                      
#   Função:         Utiliza NMAP para envio de 1 pacote TCP     #  
#                   com a flag SYN ativada.                     #
#                                                               #
#################################################################

if [ -z $1 ] || [ -z $2 ] 
then  
	
	echo -e "Send SYN Packet"
	echo -e "Informe um IP e as Portas TCP que deseja testar"
	echo -e "Exemplo: $0 37.59.24.234 80,443,22,8080" 
  
else
	echo "Dados - HOST $1 - PORTS $2" |& tee audit.$(date +%Y-%m-%d_%H:%M).log
	echo "--------------------------"	
       nmap -Pn -sS -p $2 --max-retries=1 $1 > log.txt
       cat log.txt | tr -s "//" "/" | cut -d ":" -f 3 | cut -d "/" -f 1,2,4 -s | grep -v ttp/ > result.txt
        echo -e "PORT\tSTATE\tSERVICE"; cat result.txt
       	echo "--------------------------"	
	echo "$(date)" 	
	

fi
