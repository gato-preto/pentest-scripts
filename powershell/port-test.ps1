#################################################################
#   Repositorio:    Pentest Scrpts                              #
#   Nome:           Port-Test                                   #
#   Descrição:      Testa Conexão                               #
#   Autor:          Carine Constantino                          #
#   Versão:         1.0                                         #
#   Data:           07/02/2020                                  #                                      
#   Função:         Utiliza comando nativo Test-NetConnection   #
#                   para testar se uma porta TCP/IP está Open. 	#                             
#                                                               #
#################################################################


﻿param($ip,$porta)
if(!$ip){
    echo "Port-Test"
    echo "Exemplo .\script.ps1 192.168.0.1 80"
    } else { 
if (Test-NetConnection $ip -Port $porta -WarningAction SilentlyContinue -InformationLevel Quiet){

    echo "Porta $porta Aberta no Host $ip"

    } else {

    echo "Porta $porta Fechada no Host $ip"
}
}
